<div class="dashboard-container">

  <header class="overall-stats-card" *ngIf="overall">
    <div class="stats-info">
      <div class="stat-group">
        <span class="stat-label">Total Completion</span>
        <h2 class="stat-value">
          {{ overall.totalCompleted }} <small>/ {{ overall.totalAssessments }}</small>
        </h2>
        <p class="stat-subtext">Assessments Cleared</p>
      </div>
      <div class="percentage-circle">
        <span class="percentage-number">{{ overall.overallPercentage }}%</span>
      </div>
    </div>
    <div class="master-progress-track">
      <div class="master-progress-fill" [style.width.%]="overall.overallPercentage"></div>
    </div>
  </header>

  <div class="enrolled-courses-subsection">
    <h4 class="subsection-title">My Enrolled Courses</h4>
    <div *ngIf="isLoading()" class="loading-spinner">Loading courses...</div>
    <div class="course-grid" *ngIf="!isLoading() && enrolledCourses().length > 0">
      <div class="course-item" *ngFor="let c of enrolledCourses()">
        <div class="course-content">
          <h5>{{ c.title }}</h5>
          <p>{{ c.description }}</p>
        </div>
        <button class="enroll-btn enrolled-btn" (click)="viewEnrolledCourse(c.id)">
          View Course
        </button>
      </div>
    </div>
    <div *ngIf="!isLoading() && enrolledCourses().length === 0" class="empty-message">
      <p>No enrolled courses yet. Explore available programs below!</p>
    </div>
  </div>

  <section class="discovery-section">
    <h3 class="section-title">Available Programs</h3>
    <div *ngIf="isLoading()" class="loading-spinner">Loading programs...</div>
    <div class="course-grid" *ngIf="!isLoading() && availableCourses().length > 0">
      <div class="course-item" *ngFor="let c of availableCourses()">
        <div class="course-content">
          <h5>{{ c.title }}</h5>
          <p>{{ c.description }}</p>
        </div>

        <button class="enroll-btn"
                [disabled]="c.status === 'pending'"
                [class.pending-btn]="c.status === 'pending'"
                (click)="enrollInCourse(c)">
          {{ c.status === 'pending' ? 'Pending Approval' : 'Enroll Now' }}
        </button>
      </div>
    </div>
    <div *ngIf="!isLoading() && availableCourses().length === 0" class="empty-message">
      <p>No available programs at this time.</p>
    </div>
  </section>
</div>
