<div class="page-container">
  <div class="page-header">
    <div>
      <h2>Reports</h2>
      <p>Performance analytics and course progress</p>
    </div>
    <button class="download-btn" (click)="downloadReport()">Download CSV</button>
  </div>

  <div class="card chart-card">
    <h3>Course Progress Overview</h3>
    <canvas id="performanceChart"></canvas>
  </div>

  <div class="card">
    <table class="report-table">
      <thead>
        <tr>
          <th>Student ID</th>
          <th>Student Name</th>
          <th>Course ID</th>
          <th>Course Name</th>
          <th>Progress</th>
        </tr>
      </thead>
      <tbody>
        @for (r of reports(); track r.courseId) {
          <tr>
            <td>{{ r.studentId }}</td>
            <td><strong>{{ r.studentName }}</strong></td>
            <td>{{ r.courseId }}</td>
            <td>{{ r.courseName }}</td>
            <td>
              <div class="progress-wrapper">
                <span class="progress-label">{{ r.progressPercentage }}%</span>
                <div class="progress-bar-bg">
                  <div class="progress-bar-fill" [style.width.%]="r.progressPercentage > 100 ? 100 : r.progressPercentage"></div>
                </div>
              </div>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="5" class="empty">No reports available from server</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>