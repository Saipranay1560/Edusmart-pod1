<div class="course-details">
 
  <button class="back-btn" (click)="goBack()">← Back to Courses</button>
 
  <h1>{{ course.title }}</h1>
  <p class="description">{{ course.description }}</p>
 
  <!-- Publish -->
  <div class="publish-box">
    <span>Status:
      <strong [class.published]="course.published"
              [class.draft]="!course.published">
        {{ course.published ? 'Published' : 'Draft' }}
      </strong>
    </span>
    <button (click)="togglePublish()">
      {{ course.published ? 'Unpublish' : 'Publish Course' }}
    </button>
  </div>
 
  <!-- Tabs -->
  <div class="tabs">
    <button (click)="activeTab='content'" [class.active]="activeTab==='content'">Content</button>
    <button (click)="activeTab='assignments'" [class.active]="activeTab==='assignments'">Assignments</button>
    <button (click)="activeTab='resources'" [class.active]="activeTab==='resources'">Resources</button>
    <button (click)="activeTab='progress'" [class.active]="activeTab==='progress'">Progress</button>
    <button (click)="activeTab='quiz'" [class.active]="activeTab==='quiz'">Quiz</button>
  </div>
 
  <!-- CONTENT -->
  <div *ngIf="activeTab==='content'">
    <div *ngFor="let module of course.modules; let i = index" class="module">
      <h3 (click)="toggleModule(i)" style ="cursor:pointer">{{ module.name }}</h3>
      <ul>
        <ng-container *ngIf="expandModuleIndex === i">
          <li *ngFor="let lesson of module.lessons">{{lesson}}</li>
        </ng-container>
      </ul>
    </div>
 </div>
  <!-- ASSIGNMENTS -->
  <div *ngIf="activeTab==='assignments'">
    <input type="file"(change)="onAssignmentUpload($event)" accept=".pdf" hidden #fileInput>
    <button (click)="fileInput.click()">+Add Assignment</button>
    <ul>
      <li *ngFor="let assignments of courseDetailsService.assignments">{{assignments.title}}-{{assignments.dueDate}}</li>
    </ul>
    </div>
 
  <!-- ✅ RESOURCES (REAL FILE UPLOAD — FIXED) -->
  <div *ngIf="activeTab==='resources'">
 
    <!-- Hidden inputs -->
    <input
      id="pdfUpload"
      type="file"
      accept="application/pdf"
      (change)="onPdfSelected($event)"
      hidden
    />
 
    <input
      id="videoUpload"
      type="file"
      accept="video/*"
      (change)="onVideoSelected($event)"
      hidden
    />
 
    <!-- LABELS trigger file picker -->
    <label for="pdfUpload" class="add-btn">Upload PDF</label>
    <label for="videoUpload" class="add-btn">Upload Video</label>
 
    <div class="card" *ngFor="let r of courseDetailsService.resources">
      <strong>{{ r.name }}</strong> — {{ r.type }}
    </div>
  </div>
 
  <!-- PROGRESS -->
  <div *ngIf="activeTab==='progress'">
    <h3>Course Progress</h3>
    <div class="progress-bar">
      <div class="progress-fill" [style.width.%]="courseDetailsService.progress"></div>
    </div>
    <p>{{ courseDetailsService.progress }}% completed</p>
  </div>
 
  <!-- QUIZ -->
  <div *ngIf="activeTab === 'quiz'">
 
  <input type="text" placeholder="Enter Question" [(ngModel)]="newQuestion">
 
  <input type="text" placeholder="Option 1" [(ngModel)]="option1">
  <input type="text" placeholder="Option 2" [(ngModel)]="option2">
  <input type="text" placeholder="Option 3" [(ngModel)]="option3">
  <input type="text" placeholder="Option 4" [(ngModel)]="option4">
 
  <button (click)="addQuizQuestion()">Add Question</button>
 
  <div class="quiz-list">
    <div *ngFor="let q of courseDetailsService.quiz.questions; let qi = index" class="quiz-question">
      <div>
        <strong>Q:</strong> {{ q.split(' | ')[0] }}
      </div>
      <div *ngFor="let opt of q.split(' | ')[1]?.split(','); let oi = index">
        <label>
          <input type="radio" name="quiz-{{qi}}" [value]="opt.trim()"> {{ opt.trim() }}
        </label>
      </div>
    </div>
  </div>
 
</div>